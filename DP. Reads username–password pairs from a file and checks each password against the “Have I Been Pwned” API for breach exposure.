import hashlib
import requests
def check_password_pwned(password):
    sha1_hash = hashlib.sha1(password.encode("utf-8")).hexdigest().upper()
    prefix, suffix = sha1_hash[:5], sha1_hash[5:]
    url = f"https://api.pwnedpasswords.com/range/{prefix}"
    response = requests.get(url)
    if response.status_code != 200:
        raise RuntimeError(f"API request failed with status code {response.status_code}")
    for line in response.text.splitlines():
        hash_suffix, count = line.split(":")
        if hash_suffix == suffix:
            return int(count)
    return 0
def check_file(filename):
    with open(filename, "r", encoding="utf-8") as file:
        for line in file:
            line = line.strip()
            if not line:
                continue
            try:
                username, password = line.split(",", 1)
            except ValueError:
                print(f"Invalid line format: {line}")
                continue
            count = check_password_pwned(password)
            if count:
                print(f"{username}'s password was found {count} times in breaches!")
            else:
                print(f"{username}'s password was NOT found in breaches.")
check_file('dict1.txt')
